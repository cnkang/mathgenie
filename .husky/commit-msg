#!/bin/sh
echo "ğŸ“ Checking commit message format..."

# è¯»å–commit message
commit_message=$(cat "$1")

# æ£€æŸ¥commit messageæ˜¯å¦ä¸ºç©º
if [ -z "$commit_message" ]; then
  echo "âŒ Commit message cannot be empty"
  exit 1
fi

# æ£€æŸ¥commit messageé•¿åº¦
if [ ${#commit_message} -lt 10 ]; then
  echo "âŒ Commit message too short (minimum 10 characters)"
  echo "Current message: '$commit_message'"
  exit 1
fi

# æ£€æŸ¥æ˜¯å¦åŒ…å«å¸¸è§çš„ä¸è‰¯æ¨¡å¼
case "$commit_message" in
  *"WIP"*|*"wip"*|*"TODO"*|*"todo"*|*"FIXME"*|*"fixme"*)
    echo "âŒ Commit message contains work-in-progress markers"
    echo "Please complete your work before committing"
    exit 1
    ;;
  *"fuck"*|*"shit"*|*"damn"*)
    echo "âŒ Please use professional language in commit messages"
    exit 1
    ;;
esac

# æ¨èçš„commit messageæ ¼å¼æç¤º
if ! echo "$commit_message" | grep -qE "^(feat|fix|docs|style|refactor|test|chore|perf|ci|build)(\(.+\))?: .+"; then
  echo "âš ï¸  Consider using conventional commit format:"
  echo "   feat: add new feature"
  echo "   fix: resolve bug"
  echo "   docs: update documentation"
  echo "   style: format code"
  echo "   refactor: restructure code"
  echo "   test: add tests"
  echo "   chore: maintenance tasks"
  echo "   perf: performance improvements"
  echo "   ci: CI/CD changes"
  echo "   build: build system changes"
  echo ""
  echo "Current message: '$commit_message'"
  echo ""
  echo "âœ… Commit message accepted (but consider conventional format)"
else
  echo "âœ… Commit message follows conventional format"
fi

exit 0